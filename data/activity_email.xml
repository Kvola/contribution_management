<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Templates email pour les notifications -->
    <data noupdate="1">

        <!-- Template de confirmation d'inscription -->
        <record id="email_template_registration_confirmation" model="mail.template">
            <field name="name">Confirmation d'inscription √† une activit√©</field>
            <field name="model_id" ref="contribution_management.model_member_cotisation"/>
            <field name="subject">Confirmation d'inscription - {{ object.activity_id.name }}</field>
            <field name="email_from">{{ (object.company_id.email or user.email) }}</field>
            <field name="email_to">{{ object.member_id.email }}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFFFFF;">
    <table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #FFFFFF; font-family:'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; color: rgb(34, 34, 34); width: 100%; margin:0px auto;">
        <tbody>
            <tr>
                <td align="center">
                    <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: #FFFFFF; color: rgb(34, 34, 34); border-collapse:separate;">
                        <tbody>
                            <!-- Header -->
                            <tr>
                                <td align="center" style="min-height: 80px; padding-bottom: 24px;">
                                    <img src="/web/binary/company_logo" style="padding: 0px; margin: 0px; height: auto; width: 80px;" alt="${object.company_id.name}"/>
                                </td>
                            </tr>
                            <!-- Title -->
                            <tr>
                                <td style="background-color: #28a745; padding: 20px 0px; text-align: center;">
                                    <h1 style="color: white; margin: 0; font-size: 24px;">
                                        ‚úÖ Inscription confirm√©e !
                                    </h1>
                                </td>
                            </tr>
                            <!-- Content -->
                            <tr>
                                <td style="padding: 24px 0px 0px 0px; color: rgb(34, 34, 34);">
                                    <p>F√©licitations <strong>${object.member_id.name}</strong> !</p>
                                    <p>Nous avons valid√© votre paiement. Votre inscription est maintenant <strong style="color: #28a745;">confirm√©e</strong>.</p>
                                    
                                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0; background-color: #d4edda; padding: 15px; border-radius: 5px; border-left: 4px solid #28a745;">
                                        <tr>
                                            <td><strong>Montant valid√© :</strong></td>
                                            <td><strong style="color: #155724;">${object.amount} ${object.currency_id.symbol}</strong></td>
                                        </tr>
                                        % if object.cotisation_id.activity_id:
                                        <tr>
                                            <td><strong>Activit√© :</strong></td>
                                            <td>${object.cotisation_id.activity_id.name}</td>
                                        </tr>
                                        % if object.cotisation_id.activity_id.date_start:
                                        <tr>
                                            <td><strong>Date de l'activit√© :</strong></td>
                                            <td>${format_datetime(object.cotisation_id.activity_id.date_start, tz=user.tz, dt_format='full')}</td>
                                        </tr>
                                        % endif
                                        % if object.cotisation_id.activity_id.location:
                                        <tr>
                                            <td><strong>Lieu :</strong></td>
                                            <td>${object.cotisation_id.activity_id.location}</td>
                                        </tr>
                                        % endif
                                        % endif
                                        <tr>
                                            <td><strong>Valid√© le :</strong></td>
                                            <td>${format_datetime(object.validation_date, tz=user.tz, dt_format='short')}</td>
                                        </tr>
                                    </table>

                                    <div style="background-color: #d1ecf1; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #17a2b8;">
                                        <h4 style="margin-top: 0; color: #0c5460;">üéâ Vous √™tes pr√™t !</h4>
                                        <p style="margin-bottom: 0; color: #0c5460;">
                                            Votre inscription est maintenant compl√®te. Vous recevrez d'autres informations 
                                            concernant l'activit√© si n√©cessaire.
                                            <br/>N'oubliez pas de noter la date dans votre agenda !
                                        </p>
                                    </div>

                                    % if object.cotisation_id.activity_id:
                                    <div style="text-align: center; margin: 30px 0;">
                                        <a href="${ctx.get('base_url', '')}/activity/${object.cotisation_id.activity_id.id}" 
                                           style="background-color: #007bff; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold;">
                                            üìÖ Voir les d√©tails de l'activit√©
                                        </a>
                                    </div>
                                    % endif

                                    <p>Merci de votre participation !</p>
                                    <p>Cordialement,<br/>L'√©quipe organisatrice</p>
                                </td>
                            </tr>
                            <!-- Footer -->
                            <tr>
                                <td style="text-align: center; font-size: 12px; color: rgb(120, 120, 120); padding-top: 24px; border-top: 1px solid rgb(204, 204, 204);">
                                    ${object.cotisation_id.company_id.name}
                                    % if object.cotisation_id.company_id.phone:
                                    <br/>${object.cotisation_id.company_id.phone}
                                    % endif
                                    % if object.cotisation_id.company_id.email:
                                    <br/>${object.cotisation_id.company_id.email}
                                    % endif
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            </field>
            <field name="auto_delete" eval="False"/>
        </record>

        <!-- Template de rejet de paiement -->
        <record id="email_template_payment_rejected" model="mail.template">
            <field name="name">Paiement rejet√©</field>
            <field name="model_id" ref="contribution_management.model_cotisation_payment_proof"/>
            <field name="subject">‚ùå Justificatif rejet√© - {{ object.cotisation_id.activity_id.name or 'Cotisation' }}</field>
            <field name="email_from">{{ (object.cotisation_id.company_id.email or user.email) }}</field>
            <field name="email_to">{{ object.member_id.email }}</field>
            <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: rgb(34, 34, 34); background-color: #FFFFFF;">
    <table border="0" cellpadding="0" cellspacing="0" style="padding-top: 16px; background-color: #FFFFFF; font-family:'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; color: rgb(34, 34, 34); width: 100%; margin:0px auto;">
        <tbody>
            <tr>
                <td align="center">
                    <table border="0" cellpadding="0" cellspacing="0" width="590" style="padding: 16px; background-color: #FFFFFF; color: rgb(34, 34, 34); border-collapse:separate;">
                        <tbody>
                            <!-- Header -->
                            <tr>
                                <td align="center" style="min-height: 80px; padding-bottom: 24px;">
                                    <img src="/web/binary/company_logo" style="padding: 0px; margin: 0px; height: auto; width: 80px;" alt="${object.cotisation_id.company_id.name}"/>
                                </td>
                            </tr>
                            <!-- Title -->
                            <tr>
                                <td style="background-color: #dc3545; padding: 20px 0px; text-align: center;">
                                    <h1 style="color: white; margin: 0; font-size: 24px;">
                                        ‚ùå Justificatif rejet√©
                                    </h1>
                                </td>
                            </tr>
                            <!-- Content -->
                            <tr>
                                <td style="padding: 24px 0px 0px 0px; color: rgb(34, 34, 34);">
                                    <p>Bonjour <strong>${object.member_id.name}</strong>,</p>
                                    <p>Nous avons examin√© votre justificatif de paiement, mais nous ne pouvons malheureusement pas le valider en l'√©tat.</p>
                                    
                                    <div style="background-color: #f8d7da; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #dc3545;">
                                        <h4 style="margin-top: 0; color: #721c24;">üìã D√©tails du rejet</h4>
                                        <p style="color: #721c24; margin-bottom: 5px;"><strong>Raison :</strong> 
                                            % if object.rejection_reason == 'invalid_proof':
                                                Justificatif invalide ou illisible
                                            % elif object.rejection_reason == 'amount_mismatch':
                                                Montant incorrect
                                            % elif object.rejection_reason == 'date_mismatch':
                                                Date incorrecte
                                            % elif object.rejection_reason == 'duplicate':
                                                Paiement en double
                                            % elif object.rejection_reason == 'insufficient_info':
                                                Informations insuffisantes
                                            % elif object.rejection_reason == 'fraud_suspicion':
                                                Suspicion de fraude
                                            % else:
                                                Autre raison
                                            % endif
                                        </p>
                                        % if object.validation_notes:
                                        <p style="color: #721c24; margin-bottom: 0;"><strong>Commentaires :</strong><br/>${object.validation_notes}</p>
                                        % endif
                                    </div>

                                    <div style="background-color: #fff3cd; padding: 15px; border-radius: 5px; margin: 20px 0; border-left: 4px solid #ffc107;">
                                        <h4 style="margin-top: 0; color: #856404;">üîÑ Que faire maintenant ?</h4>
                                        <ol style="margin-bottom: 0; color: #856404;">
                                            <li>V√©rifiez les informations de votre paiement</li>
                                            <li>Assurez-vous que votre justificatif est lisible et complet</li>
                                            <li>Soumettez un nouveau justificatif avec les corrections n√©cessaires</li>
                                            <li>Contactez-nous si vous avez des questions</li>
                                        </ol>
                                    </div>

                                    <div style="text-align: center; margin: 30px 0;">
                                        <a href="${ctx.get('base_url', '')}/my/cotisation/${object.cotisation_id.id}/payment" 
                                           style="background-color: #ffc107; color: #212529; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block; font-weight: bold;">
                                            üîÑ Soumettre un nouveau justificatif
                                        </a>
                                    </div>

                                    <p>N'h√©sitez pas √† nous contacter si vous avez besoin d'aide.</p>
                                    <p>Cordialement,<br/>L'√©quipe administrative</p>
                                </td>
                            </tr>
                            <!-- Footer -->
                            <tr>
                                <td style="text-align: center; font-size: 12px; color: rgb(120, 120, 120); padding-top: 24px; border-top: 1px solid rgb(204, 204, 204);">
                                    ${object.cotisation_id.company_id.name}
                                    % if object.cotisation_id.company_id.phone:
                                    <br/>${object.cotisation_id.company_id.phone}
                                    % endif
                                    % if object.cotisation_id.company_id.email:
                                    <br/>${object.cotisation_id.company_id.email}
                                    % endif
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </tbody>
    </table>
</div>
            </field>
            <field name="auto_delete" eval="False"/>
        </record>

    </data>
</odoo>